<!DOCTYPE HTML>
<html>
    <head>
        <title>Chatroom</title>
        <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/socket.io/1.3.6/socket.io.min.js"></script>
        <script>
            document.addEventListener('DOMContentLoaded', () => {
                var socket = io.connect(location.protocol + '//' + document.domain + ':' + location.port);
                const channelss = "{{channel}}"
                socket.on('connect', () =>{

                    document.querySelectorAll('#submit').forEach(button => {
                        button.onclick = () => {
                            const selection = document.querySelector('#message').value;  
                            socket.emit('submit message', {'selection': selection});
                        };
                    });
                });
                
                socket.on('submit message', data =>{
                    const li = document.createElement('li');
                    li.innerHTML = `Message: ${data.selection}`;
                    document.querySelector('#allmessages').append(li);
                    return false;
                });
            });
        </script>
    </head>

    <body>
        <h1>Chatroom</h1>
        <h3>Current channel: {{channel}}</h3>
        <p>Messages: </p>
        <ul id="allmessages"></ul>
        <input id="message" placeholder="Enter a new message..." type="text">
        <button id="submit">Send</button>
    
    </body>

</html>